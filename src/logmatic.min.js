!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.logmatic=b()}(this,function(){function a(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function b(){var a={};a.MODE={IMMEDIATE:0,LINGER:1,ERROR:2};var b=null,c=a.MODE.LINGER,d=0;return a.reset=function(){a.isScheduled()&&clearTimeout(b),b=null},a.isScheduled=function(){return null!==b},a.setMode=function(b){(c=b)!==a.MODE.ERROR&&(d=0)},a.postpone=function(e){var f;switch(a.reset(),c){case a.MODE.IMMEDIATE:f=0;break;case a.MODE.LINGER:f=k;break;case a.MODE.ERROR:var g=500*Math.pow(2,d);d++,f=Math.min(g,3e4)}b=setTimeout(e,f)},a}function c(a){a&&(j=a),console&&[{f:"log",l:"info"},{f:"info"},{f:"trace"},{f:"warn"},{f:"error"}].forEach(function(a){var b=a.f,c=a.l||a.f,d=console[b];console[b]=function(){var a=null;j&&(a={},a[j]=c);var b=Array.prototype.slice.call(arguments).map(function(a){return"object"==typeof a?JSON.stringify(a):String(a)}).join(" ");y(b,a),d.apply?d.apply(console,arguments):d(b)}})}function d(a){if(a){var b=window.TraceKit;if(b)b.report.subscribe(function(b){var c={};c[a]=b,j&&(c[j]="error"),y(b.message,c)});else{var c=window.onerror;window.onerror=function(b,d,e,f){var g={};g[a]={mode:"JSException",url:d,line:e,column:f},j&&(g[j]="error"),y(b,g),c&&"function"==typeof c&&c.apply(window,arguments)}}}}var e,f,g,h="https://api.logmatic.io/v1/input/",i={},j="severity",k=500,l=10,m=-1,n=[],o=204800,p=b(),q=function(a){h+=a},r=function(a){h=a},s=function(a){a=a||{},null!=a.lingerMs&&a.lingerMs>=0&&(k=a.lingerMs),null!=a.maxPostCount&&(a.maxPostCount<1&&(a.maxPostCount=1),l=a.maxPostCount),null!=a.maxWaitingCount&&(m=a.maxWaitingCount),null!=a.maxContentSize&&(o=a.maxContentSize)},t=function(a,b){y(a,b,"trace")},u=function(a,b){y(a,b,"debug")},v=function(a,b){y(a,b,"info")},w=function(a,b){y(a,b,"warn")},x=function(a,b){y(a,b,"error")},y=function(b,c,d){if(h){var e={message:b};e[j]=d||"info",a(c,e),z(e)}},z=function(b){a(i,b),g&&(b[g]=window.location.href),n=n||[],n.push(JSON.stringify(b)),m>=0&&n.length>m&&n.shift(),A()},A=function(){p.isScheduled()||p.postpone(B)},B=function(){function b(a){200===a||0===a?n.length>0?p.setMode(p.MODE.IMMEDIATE):p.setMode(p.MODE.LINGER):p.setMode(p.MODE.ERROR),p.reset(),0!==n.length&&A()}for(var c=[],d=0;n.length>0&&c.length<l;){var j=n.shift();if((d+=j.length)>o){if(j.length>o){var k={severity:"warn",message:"Message dropped as its size exceeded the hard limit of 200 kBytes"};a(i,k),JSON.stringify(k).length>o&&(k={severity:"error",message:"Message dropped because the context size provided exceeded the hard limit of 200 kBytes"}),k[g]=window.location.href,j=JSON.stringify(k)}n.unshift(j);break}c.push(j)}if(0===c.length)return void b(0);var m,q="["+c.join(",")+"]";m="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest,m.open("POST",h,!0),"undefined"==typeof XDomainRequest&&(m.setRequestHeader("Content-Type","application/json; charset=UTF-8"),e&&m.setRequestHeader("X-Logmatic-Add-IP",e),f&&m.setRequestHeader("X-Logmatic-Add-UserAgent",f)),m.onerror=function(a){b(a.target.status)},m.onload=function(a){b(a.target.status)},m.send(q)},C=function(a){i=a},D=function(a,b){i[a]=b},E=function(a){g=a};return{init:q,log:v,trace:t,debug:u,info:v,warn:w,error:x,forceEndpoint:r,setMetas:C,addMeta:D,setSendErrors:d,setSendConsoleErrors:d,setSendConsoleLogs:c,setIPTracking:function(a){e=a},setUserAgentTracking:function(a){f=a},setURLTracking:E,setBulkOptions:s}});
//# sourceMappingURL=logmatic.min.js.map